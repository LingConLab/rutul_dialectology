---
title: Ergative suffix in the MED demonstrative
author: Maksim Melenchenko
date: 'Last update: `r lubridate::make_datetime(year = 2024, month = 3, day = 8)`'
output:
  html_document:
    number_sections: true
    anchor_sections: true
    pandoc_args: --shift-heading-level-by=-1
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning=FALSE, fig.width = 9.5)
library(tidyverse)
library(lingtypology)
read_csv('data/database.csv', show_col_types = FALSE) |> 
  filter(feature_id == 199) ->
  db
read_csv('data/villages.csv') |> 
  filter(!(village %in% c('Kazankulak', 'Novyy Borch', 'Vrush', 'Aran', 'Khnyukh'))) ->
  villages
  
villages |> 
  filter(!(village %in% c('Tsudik', 'Borch'))) ->
  villages4map
  
```

This feature shows the specific form of the ergative suffix used with the medial (*ha*-) demonstrative. This is the suffix attached to the ergative stem of the demonstrative. There are four contexts to distinguish between human / non-human referents and singular / plural referents. The speakers were asked to translate four sentences: ‘**He** said that’ (human singular), ‘**They** said that’ (human plural), ‘[The cow died.] **She** ate bad grass’ (non-human singular), ‘[The cows died.] **They** ate bad grass’ (non-human plural). For each speaker, first reaction was coded (although the elicitor tried to make sure that this reaction was not an error due to the misunderstanding of the context).
The context with the singular human referent shows significant variance. The following variants of the ergative suffix were attested: -*ra* in Ikhrek and Khnov; -*e* in Rutul and adjacent villages; -*r*, -*a* or null suffix in other villages. With singular non-human referents, suffixes -*r*, -*ra* and -*re* were used. The suffix -*re* is used in Shinaz, Rutul and adjacent villages, -*ra* in Luchek and several adjacent villages, -*r* in Ikhrek, Kina, Khnov and other settlements.
With plural human referents, -*ra* is used in Khnov and in one case in Ikhrek, null suffix in several villages around Myukhrek and Amsar, and -*e* in other villages. With plural non-human referents, -*r* is used in Myukhrek, Luchek, Amsar and adjacent villages, and -*ra* in other villages.


## singular, human

::: {.panel-tabset}

### Map

```{r}
db |> 
  filter(feature_lexeme == 'singular, human')  |>
  filter(!is.na(value),
         value != 'NO DATA') |>
  mutate(value = str_split(value, ' ; ')) |> 
  unnest_longer(value) |> 
  distinct(settlement, value) |> 
  mutate(n = 1) |> 
  pivot_wider(names_from = value, values_from = n, values_fill = 0) |> 
  left_join(villages[,c('village', 'lat', 'lon')], c('settlement' = 'village')) |> 
  mutate(language = 'Rutul') ->
  for_map
  
if(length(for_map) == 5){
map.feature(languages = 'Rutul',
            latitude = villages4map$lat,
            longitude = villages4map$lon,
            label = villages4map$village,
            label.position = 'top',
            label.hide = FALSE,
            width = 10,
            color = 'gray',
            tile = 'OpenStreetMap.HOT',
            opacity = 0.4) |> 
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              width = 10,
              tile = 'OpenStreetMap.HOT',
              features = colnames(for_map)[2],
              pipe.data = _)  
} else {
map.feature(languages = 'Rutul',
            latitude = villages4map$lat,
            longitude = villages4map$lon,
            label = villages4map$village,
            label.position = 'top',
            label.hide = FALSE,
            width = 10,
            color = 'gray',
            tile = 'OpenStreetMap.HOT',
            opacity = 0.4) |> 
  map.feature(languages = for_map$language,
            latitude = for_map$lat,
            longitude = for_map$lon,
            minichart.data = for_map |> select(-settlement, -lat, -lon, -language),
            minichart = 'pie', 
            width = 3,
            tile = 'OpenStreetMap.HOT',
            pipe.data = _)
}
```

### Data

```{r}
db |> 
  filter(feature_lexeme == 'singular, human') |> 
  select(settlement, value, stimuli, answer, collected) |> 
  DT::datatable(class = 'cell-border stripe', 
    rownames = FALSE, 
    filter = 'top', 
    extensions = 'Buttons',
    options = list(pageLength = 42, 
                   autoWidth = TRUE, 
                   info = FALSE,
                   dom = 'fBltp',
                   buttons = list(list(extend = 'collection',
                                       buttons = c('csv', 'excel', 'pdf'),
                                       text = '<i class="fas fa-download"></i>')),
                   paginate = TRUE))
```
:::

## singular, non-human

::: {.panel-tabset}

### Map

```{r}
db |> 
  filter(feature_lexeme == 'singular, non-human')  |>
  filter(!is.na(value),
         value != 'NO DATA') |>
  mutate(value = str_split(value, ' ; ')) |> 
  unnest_longer(value) |> 
  distinct(settlement, value) |> 
  mutate(n = 1) |> 
  pivot_wider(names_from = value, values_from = n, values_fill = 0) |> 
  left_join(villages[,c('village', 'lat', 'lon')], c('settlement' = 'village')) |> 
  mutate(language = 'Rutul') ->
  for_map
  
if(length(for_map) == 5){
map.feature(languages = 'Rutul',
            latitude = villages4map$lat,
            longitude = villages4map$lon,
            label = villages4map$village,
            label.position = 'top',
            label.hide = FALSE,
            width = 10,
            color = 'gray',
            tile = 'OpenStreetMap.HOT',
            opacity = 0.4) |> 
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              width = 10,
              tile = 'OpenStreetMap.HOT',
              features = colnames(for_map)[2],
              pipe.data = _)  
} else {
map.feature(languages = 'Rutul',
            latitude = villages4map$lat,
            longitude = villages4map$lon,
            label = villages4map$village,
            label.position = 'top',
            label.hide = FALSE,
            width = 10,
            color = 'gray',
            tile = 'OpenStreetMap.HOT',
            opacity = 0.4) |> 
  map.feature(languages = for_map$language,
            latitude = for_map$lat,
            longitude = for_map$lon,
            minichart.data = for_map |> select(-settlement, -lat, -lon, -language),
            minichart = 'pie', 
            width = 3,
            tile = 'OpenStreetMap.HOT',
            pipe.data = _)
}
```

### Data

```{r}
db |> 
  filter(feature_lexeme == 'singular, non-human') |> 
  select(settlement, value, stimuli, answer, collected) |> 
  DT::datatable(class = 'cell-border stripe', 
    rownames = FALSE, 
    filter = 'top', 
    extensions = 'Buttons',
    options = list(pageLength = 42, 
                   autoWidth = TRUE, 
                   info = FALSE,
                   dom = 'fBltp',
                   buttons = list(list(extend = 'collection',
                                       buttons = c('csv', 'excel', 'pdf'),
                                       text = '<i class="fas fa-download"></i>')),
                   paginate = TRUE))
```
:::

## plural, human

::: {.panel-tabset}

### Map

```{r}
db |> 
  filter(feature_lexeme == 'plural, human')  |>
  filter(!is.na(value),
         value != 'NO DATA') |>
  mutate(value = str_split(value, ' ; ')) |> 
  unnest_longer(value) |> 
  distinct(settlement, value) |> 
  mutate(n = 1) |> 
  pivot_wider(names_from = value, values_from = n, values_fill = 0) |> 
  left_join(villages[,c('village', 'lat', 'lon')], c('settlement' = 'village')) |> 
  mutate(language = 'Rutul') ->
  for_map
  
if(length(for_map) == 5){
map.feature(languages = 'Rutul',
            latitude = villages4map$lat,
            longitude = villages4map$lon,
            label = villages4map$village,
            label.position = 'top',
            label.hide = FALSE,
            width = 10,
            color = 'gray',
            tile = 'OpenStreetMap.HOT',
            opacity = 0.4) |> 
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              width = 10,
              tile = 'OpenStreetMap.HOT',
              features = colnames(for_map)[2],
              pipe.data = _)  
} else {
map.feature(languages = 'Rutul',
            latitude = villages4map$lat,
            longitude = villages4map$lon,
            label = villages4map$village,
            label.position = 'top',
            label.hide = FALSE,
            width = 10,
            color = 'gray',
            tile = 'OpenStreetMap.HOT',
            opacity = 0.4) |> 
  map.feature(languages = for_map$language,
            latitude = for_map$lat,
            longitude = for_map$lon,
            minichart.data = for_map |> select(-settlement, -lat, -lon, -language),
            minichart = 'pie', 
            width = 3,
            tile = 'OpenStreetMap.HOT',
            pipe.data = _)
}
```

### Data

```{r}
db |> 
  filter(feature_lexeme == 'plural, human') |> 
  select(settlement, value, stimuli, answer, collected) |> 
  DT::datatable(class = 'cell-border stripe', 
    rownames = FALSE, 
    filter = 'top', 
    extensions = 'Buttons',
    options = list(pageLength = 42, 
                   autoWidth = TRUE, 
                   info = FALSE,
                   dom = 'fBltp',
                   buttons = list(list(extend = 'collection',
                                       buttons = c('csv', 'excel', 'pdf'),
                                       text = '<i class="fas fa-download"></i>')),
                   paginate = TRUE))
```
:::

## plural, non-human

::: {.panel-tabset}

### Map

```{r}
db |> 
  filter(feature_lexeme == 'plural, non-human')  |>
  filter(!is.na(value),
         value != 'NO DATA') |>
  mutate(value = str_split(value, ' ; ')) |> 
  unnest_longer(value) |> 
  distinct(settlement, value) |> 
  mutate(n = 1) |> 
  pivot_wider(names_from = value, values_from = n, values_fill = 0) |> 
  left_join(villages[,c('village', 'lat', 'lon')], c('settlement' = 'village')) |> 
  mutate(language = 'Rutul') ->
  for_map
  
if(length(for_map) == 5){
map.feature(languages = 'Rutul',
            latitude = villages4map$lat,
            longitude = villages4map$lon,
            label = villages4map$village,
            label.position = 'top',
            label.hide = FALSE,
            width = 10,
            color = 'gray',
            tile = 'OpenStreetMap.HOT',
            opacity = 0.4) |> 
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              width = 10,
              tile = 'OpenStreetMap.HOT',
              features = colnames(for_map)[2],
              pipe.data = _)  
} else {
map.feature(languages = 'Rutul',
            latitude = villages4map$lat,
            longitude = villages4map$lon,
            label = villages4map$village,
            label.position = 'top',
            label.hide = FALSE,
            width = 10,
            color = 'gray',
            tile = 'OpenStreetMap.HOT',
            opacity = 0.4) |> 
  map.feature(languages = for_map$language,
            latitude = for_map$lat,
            longitude = for_map$lon,
            minichart.data = for_map |> select(-settlement, -lat, -lon, -language),
            minichart = 'pie', 
            width = 3,
            tile = 'OpenStreetMap.HOT',
            pipe.data = _)
}
```

### Data

```{r}
db |> 
  filter(feature_lexeme == 'plural, non-human') |> 
  select(settlement, value, stimuli, answer, collected) |> 
  DT::datatable(class = 'cell-border stripe', 
    rownames = FALSE, 
    filter = 'top', 
    extensions = 'Buttons',
    options = list(pageLength = 42, 
                   autoWidth = TRUE, 
                   info = FALSE,
                   dom = 'fBltp',
                   buttons = list(list(extend = 'collection',
                                       buttons = c('csv', 'excel', 'pdf'),
                                       text = '<i class="fas fa-download"></i>')),
                   paginate = TRUE))
```
:::

