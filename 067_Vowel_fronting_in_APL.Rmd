---
title: Vowel fronting in APL
author: Nina Dobrushina
date: 'Last update: `r lubridate::make_datetime(year = 2023, month = 5, day = 23)`'
output:
  html_document:
    number_sections: true
    anchor_sections: true
    pandoc_args: --shift-heading-level-by=-1
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning=FALSE, fig.width = 9.5)
library(tidyverse)
library(lingtypology)
db <- read_csv('data/database.csv') %>% filter(feature_id == 67)
villages <- read_csv('data/villages.csv')
```

In some verbs, the vowel -u- may alternate with -i- or -Ã¼- when the verb agrees with an animate plural subject.


## sitHPL {.tabset .tabset-fade .tabset-pills}

### Map

```{r}
db %>% 
  filter(feature_lexeme == 'sitHPL')  %>%
  filter(!is.na(value)) %>%
  mutate(value = str_split(value, ' ; ')) %>% 
  unnest_longer(value) %>% 
  distinct(settlement, value) %>% 
  mutate(n = 1) %>% 
  pivot_wider(names_from = value, values_from = n, values_fill = 0) %>% 
  left_join(villages[,c('village', 'lat', 'lon')], c('settlement' = 'village')) %>% 
  mutate(language = 'Rutul') ->
  for_map
  
if(length(for_map) == 5){
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              width = 10,
              features = colnames(for_map)[2])  
} else {
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              minichart.data = for_map %>% select(-settlement, -lat, -lon, -language),
              minichart = 'pie', 
              width = 3)
}
```

### Data

```{r}
db %>% 
  filter(feature_lexeme == 'sitHPL') %>% 
  select(settlement, value, stimuli, answer, collected) %>% 
  DT::datatable(class = 'cell-border stripe', 
    rownames = FALSE, 
    filter = 'top', 
    extensions = 'Buttons',
    options = list(pageLength = 42, 
                   autoWidth = TRUE, 
                   info = FALSE,
                   dom = 'fBltp',
                   buttons = list(list(extend = 'collection',
                                       buttons = c('csv', 'excel', 'pdf'),
                                       text = '<i class="fas fa-download"></i>')),
                   paginate = TRUE))
```


## walk1SG {.tabset .tabset-fade .tabset-pills}

### Map

```{r}
db %>% 
  filter(feature_lexeme == 'walk1SG')  %>%
  filter(!is.na(value)) %>%
  mutate(value = str_split(value, ' ; ')) %>% 
  unnest_longer(value) %>% 
  distinct(settlement, value) %>% 
  mutate(n = 1) %>% 
  pivot_wider(names_from = value, values_from = n, values_fill = 0) %>% 
  left_join(villages[,c('village', 'lat', 'lon')], c('settlement' = 'village')) %>% 
  mutate(language = 'Rutul') ->
  for_map
  
if(length(for_map) == 5){
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              width = 10,
              features = colnames(for_map)[2])  
} else {
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              minichart.data = for_map %>% select(-settlement, -lat, -lon, -language),
              minichart = 'pie', 
              width = 3)
}
```

### Data

```{r}
db %>% 
  filter(feature_lexeme == 'walk1SG') %>% 
  select(settlement, value, stimuli, answer, collected) %>% 
  DT::datatable(class = 'cell-border stripe', 
    rownames = FALSE, 
    filter = 'top', 
    extensions = 'Buttons',
    options = list(pageLength = 42, 
                   autoWidth = TRUE, 
                   info = FALSE,
                   dom = 'fBltp',
                   buttons = list(list(extend = 'collection',
                                       buttons = c('csv', 'excel', 'pdf'),
                                       text = '<i class="fas fa-download"></i>')),
                   paginate = TRUE))
```


## walkHPL {.tabset .tabset-fade .tabset-pills}

### Map

```{r}
db %>% 
  filter(feature_lexeme == 'walkHPL')  %>%
  filter(!is.na(value)) %>%
  mutate(value = str_split(value, ' ; ')) %>% 
  unnest_longer(value) %>% 
  distinct(settlement, value) %>% 
  mutate(n = 1) %>% 
  pivot_wider(names_from = value, values_from = n, values_fill = 0) %>% 
  left_join(villages[,c('village', 'lat', 'lon')], c('settlement' = 'village')) %>% 
  mutate(language = 'Rutul') ->
  for_map
  
if(length(for_map) == 5){
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              width = 10,
              features = colnames(for_map)[2])  
} else {
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              minichart.data = for_map %>% select(-settlement, -lat, -lon, -language),
              minichart = 'pie', 
              width = 3)
}
```

### Data

```{r}
db %>% 
  filter(feature_lexeme == 'walkHPL') %>% 
  select(settlement, value, stimuli, answer, collected) %>% 
  DT::datatable(class = 'cell-border stripe', 
    rownames = FALSE, 
    filter = 'top', 
    extensions = 'Buttons',
    options = list(pageLength = 42, 
                   autoWidth = TRUE, 
                   info = FALSE,
                   dom = 'fBltp',
                   buttons = list(list(extend = 'collection',
                                       buttons = c('csv', 'excel', 'pdf'),
                                       text = '<i class="fas fa-download"></i>')),
                   paginate = TRUE))
```


## sit1SG {.tabset .tabset-fade .tabset-pills}

### Map

```{r}
db %>% 
  filter(feature_lexeme == 'sit1SG')  %>%
  filter(!is.na(value)) %>%
  mutate(value = str_split(value, ' ; ')) %>% 
  unnest_longer(value) %>% 
  distinct(settlement, value) %>% 
  mutate(n = 1) %>% 
  pivot_wider(names_from = value, values_from = n, values_fill = 0) %>% 
  left_join(villages[,c('village', 'lat', 'lon')], c('settlement' = 'village')) %>% 
  mutate(language = 'Rutul') ->
  for_map
  
if(length(for_map) == 5){
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              width = 10,
              features = colnames(for_map)[2])  
} else {
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              minichart.data = for_map %>% select(-settlement, -lat, -lon, -language),
              minichart = 'pie', 
              width = 3)
}
```

### Data

```{r}
db %>% 
  filter(feature_lexeme == 'sit1SG') %>% 
  select(settlement, value, stimuli, answer, collected) %>% 
  DT::datatable(class = 'cell-border stripe', 
    rownames = FALSE, 
    filter = 'top', 
    extensions = 'Buttons',
    options = list(pageLength = 42, 
                   autoWidth = TRUE, 
                   info = FALSE,
                   dom = 'fBltp',
                   buttons = list(list(extend = 'collection',
                                       buttons = c('csv', 'excel', 'pdf'),
                                       text = '<i class="fas fa-download"></i>')),
                   paginate = TRUE))
```


## playHPL {.tabset .tabset-fade .tabset-pills}

### Map

```{r}
db %>% 
  filter(feature_lexeme == 'playHPL')  %>%
  filter(!is.na(value)) %>%
  mutate(value = str_split(value, ' ; ')) %>% 
  unnest_longer(value) %>% 
  distinct(settlement, value) %>% 
  mutate(n = 1) %>% 
  pivot_wider(names_from = value, values_from = n, values_fill = 0) %>% 
  left_join(villages[,c('village', 'lat', 'lon')], c('settlement' = 'village')) %>% 
  mutate(language = 'Rutul') ->
  for_map
  
if(length(for_map) == 5){
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              width = 10,
              features = colnames(for_map)[2])  
} else {
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              minichart.data = for_map %>% select(-settlement, -lat, -lon, -language),
              minichart = 'pie', 
              width = 3)
}
```

### Data

```{r}
db %>% 
  filter(feature_lexeme == 'playHPL') %>% 
  select(settlement, value, stimuli, answer, collected) %>% 
  DT::datatable(class = 'cell-border stripe', 
    rownames = FALSE, 
    filter = 'top', 
    extensions = 'Buttons',
    options = list(pageLength = 42, 
                   autoWidth = TRUE, 
                   info = FALSE,
                   dom = 'fBltp',
                   buttons = list(list(extend = 'collection',
                                       buttons = c('csv', 'excel', 'pdf'),
                                       text = '<i class="fas fa-download"></i>')),
                   paginate = TRUE))
```


## play3SG {.tabset .tabset-fade .tabset-pills}

### Map

```{r}
db %>% 
  filter(feature_lexeme == 'play3SG')  %>%
  filter(!is.na(value)) %>%
  mutate(value = str_split(value, ' ; ')) %>% 
  unnest_longer(value) %>% 
  distinct(settlement, value) %>% 
  mutate(n = 1) %>% 
  pivot_wider(names_from = value, values_from = n, values_fill = 0) %>% 
  left_join(villages[,c('village', 'lat', 'lon')], c('settlement' = 'village')) %>% 
  mutate(language = 'Rutul') ->
  for_map
  
if(length(for_map) == 5){
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              width = 10,
              features = colnames(for_map)[2])  
} else {
  map.feature(languages = for_map$language,
              latitude = for_map$lat,
              longitude = for_map$lon,
              label = for_map$settlement,
              label.position = 'top',
              label.hide = FALSE,
              minichart.data = for_map %>% select(-settlement, -lat, -lon, -language),
              minichart = 'pie', 
              width = 3)
}
```

### Data

```{r}
db %>% 
  filter(feature_lexeme == 'play3SG') %>% 
  select(settlement, value, stimuli, answer, collected) %>% 
  DT::datatable(class = 'cell-border stripe', 
    rownames = FALSE, 
    filter = 'top', 
    extensions = 'Buttons',
    options = list(pageLength = 42, 
                   autoWidth = TRUE, 
                   info = FALSE,
                   dom = 'fBltp',
                   buttons = list(list(extend = 'collection',
                                       buttons = c('csv', 'excel', 'pdf'),
                                       text = '<i class="fas fa-download"></i>')),
                   paginate = TRUE))
```


