<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.533">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Francois Guillem">

<title>Атлас рутульских диалектов - Introduction to leaflet.minicharts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Поиск не дал результатов",
    "search-matching-documents-text": "Результаты поиска",
    "search-copy-link-title": "Скопировать ссылку",
    "search-hide-matches-text": "Скрыть дополнительные результаты",
    "search-more-match-text": "дополнительный результат в этом документе",
    "search-more-matches-text": "дополнительных результата(-ов) в этом документе",
    "search-clear-button-title": "Очистить",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Отменить",
    "search-submit-button-title": "Найти",
    "search-label": "Поиск"
  }
}</script>
<script src="../../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../../../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="../../../../site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="../../../../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="../../../../site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="../../../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="../../../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="../../../../site_libs/leaflet-binding-2.2.1/leaflet.js"></script>
<link href="../../../../site_libs/minichart-0.2.2/minicharts.css" rel="stylesheet">
<script src="../../../../site_libs/minichart-0.2.2/leaflet.minicharts.min.js"></script>
<link href="../../../../site_libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">Атлас рутульских диалектов</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Поиск"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Переключить навигацию" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../.././features.html"> <i class="bi bi-fa-atlas" role="img">
</i> 
<span class="menu-text">Список признаков</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../.././team.html"> 
<span class="menu-text">О нас</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../.././../index.html"> 
<span class="menu-text">English</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction to leaflet.minicharts</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Автор</div>
    <div class="quarto-title-meta-contents">
             <p>Francois Guillem </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Дата публикации</div>
    <div class="quarto-title-meta-contents">
      <p class="date">28 декабря 2023 г.</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>For a few years now, it has become very to create interactive maps with R thanks to the package <code>leaflet</code> by the Rstudio team. Nevertheless, it only provides only a few functions to create basic shapes on a map, so the information that can be represented on a single map is limited: if you have some data associated to some points, you can only represent at most two variables by drawing circles and changing their radius and color according to data.</p>
<p><code>leaflet.minicharts</code> is an R package that provides two functions to add and update small charts on an interactive maps created with the package <code>leaflet</code>. These charts can be used to represent as many variables as desired associated to geographical points. Currently, three types of chart are supported: barcharts (the default), pie charts and polar area charts.</p>
<p>let’s have a look to a concrete example.</p>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<p>The package provides a table that contains the electric production, consumption and exchanges of France from january 2010 to february 2017 and of 12 french regions from january 2013 to february 2017.</p>
<p>In addition to the total production, the table contains one column for each type of production. The table also contains the latitude and longitude of the center of the regions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet.minicharts)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"eco2mix"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(eco2mix)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  area      lng      lat   month total nuclear coal fuel gaz
1 Auvergne-Rhone-Alpes 4.537338 45.51266 2015-03 11430    8230    6   40 200
2 Auvergne-Rhone-Alpes 4.537338 45.51266 2015-06 10056    7200    4   35   5
3 Auvergne-Rhone-Alpes 4.537338 45.51266 2013-04 10532    7410    0   31   3
4 Auvergne-Rhone-Alpes 4.537338 45.51266 2015-04 10103    7275    4   39  86
5 Auvergne-Rhone-Alpes 4.537338 45.51266 2014-08  9052    6357    0   25  -1
6 Auvergne-Rhone-Alpes 4.537338 45.51266 2015-11  9258    7192    5   45 250
  hydraulic wind solar bioenergy load balance export import balanceUK balanceES
1      2737   74    57        82 6326    4747     NA     NA        NA        NA
2      2606   44   101        58 4848    4891     NA     NA        NA        NA
3      2948   55    39        42   NA      NA     NA     NA        NA        NA
4      2487   66    81        61 5283    4439     NA     NA        NA        NA
5      2487   38    76        68 4299    4447     NA     NA        NA        NA
6      1563   75    40        86 5829    3141     NA     NA        NA        NA
  balanceIT balanceCH balanceDEBE
1        NA        NA          NA
2        NA        NA          NA
3        NA        NA          NA
4        NA        NA          NA
5        NA        NA          NA
6        NA        NA          NA</code></pre>
</div>
</div>
</section>
<section id="renewable-productions-in-2016" class="level2">
<h2 class="anchored" data-anchor-id="renewable-productions-in-2016">Renewable productions in 2016</h2>
<p>Nowadays, France has an objective of 23% of renewable energies in the consumption of the country by 2020. Are the country close to its objective. Is the share of renewable energies similar in all regions?</p>
<p>To answer this question let us focus on the year 2016 We first prepare the required data with package <code>dplyr</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>prod2016 <span class="ot">&lt;-</span> eco2mix <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">renewable =</span> bioenergy <span class="sc">+</span> solar <span class="sc">+</span> wind <span class="sc">+</span> hydraulic,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">non_renewable =</span> total <span class="sc">-</span> bioenergy <span class="sc">-</span> solar <span class="sc">-</span> wind <span class="sc">-</span> hydraulic</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"2016"</span>, month) <span class="sc">&amp;</span> area <span class="sc">!=</span> <span class="st">"France"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>month) <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(area, lat, lng) <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(sum) <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(prod2016)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 23
  area          lat   lng  total nuclear  coal  fuel   gaz hydraulic  wind solar
  &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Auvergne-R…  45.5  4.54 108517   75002    59   101  2318     28398   849   803
2 Bourgogne-…  47.2  4.81   2762       0     0     1   644       939   773   211
3 Bretagne     48.2 -2.84   3141       0     0     9   543       581  1472   192
4 Centre-Val…  47.5  1.69  78430   75733     0     0   274       120  1616   238
5 Grand-Est    48.7  5.61 107755   82734  1650    41  8282      8990  4917   462
6 Hauts-de-F…  50.0  2.77  45593   31222    48    17  8302         8  4851   122
# ℹ 12 more variables: bioenergy &lt;dbl&gt;, load &lt;dbl&gt;, balance &lt;dbl&gt;,
#   export &lt;dbl&gt;, import &lt;dbl&gt;, balanceUK &lt;dbl&gt;, balanceES &lt;dbl&gt;,
#   balanceIT &lt;dbl&gt;, balanceCH &lt;dbl&gt;, balanceDEBE &lt;dbl&gt;, renewable &lt;dbl&gt;,
#   non_renewable &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We also create a base map that will be used in all the following examples</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>tilesURL <span class="ot">&lt;-</span> <span class="st">"http://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}"</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>basemap <span class="ot">&lt;-</span> <span class="fu">leaflet</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"400px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>(tilesURL)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now add to the base map a pie chart for each region that represents the share of renewable energies. We also change the width of the pie charts so their area is proportional to the total production of the corresponding region.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#4fc13c"</span>, <span class="st">"#cccccc"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>basemap <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMinicharts</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    prod2016<span class="sc">$</span>lng, prod2016<span class="sc">$</span>lat,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"pie"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">chartdata =</span> prod2016[, <span class="fu">c</span>(<span class="st">"renewable"</span>, <span class="st">"non_renewable"</span>)], </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colorPalette =</span> colors, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">60</span> <span class="sc">*</span> <span class="fu">sqrt</span>(prod2016<span class="sc">$</span>total) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">max</span>(prod2016<span class="sc">$</span>total)), <span class="at">transitionTime =</span> <span class="dv">0</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-bf3ea39ad1f2e3e96bc3" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-bf3ea39ad1f2e3e96bc3">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["http://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false}]},{"method":"addMinicharts","args":[[{"dyn":{"width":[14.21966011685714]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":0,"fillColor":"#1f77b4","layerId":"_minichart (-0.813282566731742,47.4792988912507)","lat":47.47929889125071,"lng":-0.8132825667317425},"timeSteps":1},{"dyn":{"width":[10.20789817091537]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":0,"fillColor":"#1f77b4","layerId":"_minichart (-2.84162054154278,48.1729948540771)","lat":48.17299485407708,"lng":-2.841620541542783},"timeSteps":1},{"dyn":{"width":[46.15771210011769]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":0,"fillColor":"#1f77b4","layerId":"_minichart (0.110020840062141,49.1203330851779)","lat":49.12033308517789,"lng":0.1100208400621413},"timeSteps":1},{"dyn":{"width":[41.38198900574412]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":0,"fillColor":"#1f77b4","layerId":"_minichart (0.218483284171458,45.2025394648037)","lat":45.20253946480369,"lng":0.2184832841714578},"timeSteps":1},{"dyn":{"width":[51.00860757516961]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":0,"fillColor":"#1f77b4","layerId":"_minichart (1.68510931295538,47.4847992664932)","lat":47.48479926649323,"lng":1.685109312955383},"timeSteps":1},{"dyn":{"width":[34.74985947702616]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":0,"fillColor":"#1f77b4","layerId":"_minichart (2.145955512601,43.7024322746127)","lat":43.7024322746127,"lng":2.145955512601003},"timeSteps":1},{"dyn":{"width":[11.08056494191421]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":0,"fillColor":"#1f77b4","layerId":"_minichart (2.5040817406415,48.7093394514858)","lat":48.70933945148577,"lng":2.504081740641503},"timeSteps":1},{"dyn":{"width":[38.89120913492938]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":0,"fillColor":"#1f77b4","layerId":"_minichart (2.77194462302643,49.9699454427889)","lat":49.96994544278894,"lng":2.771944623026433},"timeSteps":1},{"dyn":{"width":[60]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":0,"fillColor":"#1f77b4","layerId":"_minichart (4.53733758362306,45.5126596875538)","lat":45.51265968755384,"lng":4.537337583623057},"timeSteps":1},{"dyn":{"width":[9.572253645108416]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":0,"fillColor":"#1f77b4","layerId":"_minichart (4.80741109095619,47.2343259051064)","lat":47.23432590510637,"lng":4.807411090956194},"timeSteps":1},{"dyn":{"width":[59.78897065056753]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":0,"fillColor":"#1f77b4","layerId":"_minichart (5.61388404127418,48.6888920841392)","lat":48.68889208413923,"lng":5.61388404127418},"timeSteps":1},{"dyn":{"width":[26.65456136063932]},"static":{"type":"pie","height":30,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":0,"fillColor":"#1f77b4","layerId":"_minichart (6.06550427708522,43.9580632682766)","lat":43.95806326827664,"lng":6.065504277085216},"timeSteps":1}],[[[2034,4061]],[[2564,577]],[[1836,62386]],[[8508,43112]],[[2392,76038]],[[16283,20117]],[[1366,2335]],[[5963,39630]],[[30999,77518]],[[2095,667]],[[15011,92744]],[[11355,10061]]],92744,["#4fc13c","#cccccc"],["1"],null,{"showTitle":true,"showValues":true,"labels":["renewable","non_renewable"],"supValues":null,"supLabels":[],"html":null,"noPopup":false,"digits":null},null,null]},{"method":"addLegend","args":[{"colors":["#4fc13c","#cccccc"],"labels":["renewable","non_renewable"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":null,"extra":null,"layerId":"minichartsLegend","className":"info legend","group":null}]}],"limits":{"lat":[43.7024322746127,49.96994544278894],"lng":[-2.841620541542783,6.065504277085216]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>We can see that the three south east regions exceed the target of 23%, but most regions are far from this objective. Globally, renewable energies represented only 19% percent of the production of 2016.</p>
<p>Now let’s represent the different types of renewable production using bar charts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>renewable2016 <span class="ot">&lt;-</span> prod2016 <span class="sc">%&gt;%</span> <span class="fu">select</span>(hydraulic, solar, wind)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#3093e5"</span>, <span class="st">"#fcba50"</span>, <span class="st">"#a0d9e8"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>basemap <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMinicharts</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    prod2016<span class="sc">$</span>lng, prod2016<span class="sc">$</span>lat,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">chartdata =</span> renewable2016,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">colorPalette =</span> colors,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">45</span>, <span class="at">height =</span> <span class="dv">45</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-19d40e0dea067104e15b" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-19d40e0dea067104e15b">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["http://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false}]},{"method":"addMinicharts","args":[[{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (-0.813282566731742,47.4792988912507)","lat":47.47929889125071,"lng":-0.8132825667317425},"timeSteps":1},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (-2.84162054154278,48.1729948540771)","lat":48.17299485407708,"lng":-2.841620541542783},"timeSteps":1},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (0.110020840062141,49.1203330851779)","lat":49.12033308517789,"lng":0.1100208400621413},"timeSteps":1},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (0.218483284171458,45.2025394648037)","lat":45.20253946480369,"lng":0.2184832841714578},"timeSteps":1},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (1.68510931295538,47.4847992664932)","lat":47.48479926649323,"lng":1.685109312955383},"timeSteps":1},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (2.145955512601,43.7024322746127)","lat":43.7024322746127,"lng":2.145955512601003},"timeSteps":1},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (2.5040817406415,48.7093394514858)","lat":48.70933945148577,"lng":2.504081740641503},"timeSteps":1},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (2.77194462302643,49.9699454427889)","lat":49.96994544278894,"lng":2.771944623026433},"timeSteps":1},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (4.53733758362306,45.5126596875538)","lat":45.51265968755384,"lng":4.537337583623057},"timeSteps":1},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (4.80741109095619,47.2343259051064)","lat":47.23432590510637,"lng":4.807411090956194},"timeSteps":1},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (5.61388404127418,48.6888920841392)","lat":48.68889208413923,"lng":5.61388404127418},"timeSteps":1},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (6.06550427708522,43.9580632682766)","lat":43.95806326827664,"lng":6.065504277085216},"timeSteps":1}],[[[13,438,1253]],[[581,192,1472]],[[123,122,1179]],[[3935,2213,913]],[[120,238,1616]],[[11077,1829,2635]],[[51,65,55]],[[8,122,4851]],[[28398,803,849]],[[939,211,773]],[[8990,462,4917]],[[9122,1347,103]]],28398,["#3093e5","#fcba50","#a0d9e8"],["1"],null,{"showTitle":true,"showValues":true,"labels":["hydraulic","solar","wind"],"supValues":null,"supLabels":[],"html":null,"noPopup":false,"digits":null},null,null]},{"method":"addLegend","args":[{"colors":["#3093e5","#fcba50","#a0d9e8"],"labels":["hydraulic","solar","wind"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":null,"extra":null,"layerId":"minichartsLegend","className":"info legend","group":null}]}],"limits":{"lat":[43.7024322746127,49.96994544278894],"lng":[-2.841620541542783,6.065504277085216]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Hydraulic production is far more important than solar and wind. Without surprise, solar production is more important in south while wind production is more important in the north.</p>
</section>
<section id="representing-a-single-variable" class="level2">
<h2 class="anchored" data-anchor-id="representing-a-single-variable">Representing a single variable</h2>
<p><code>leaflet.minicharts</code> has been designed to represent multiple variables at once, but you still may want to use it to represent a single variable. In the next example, we represent the total load of each french region in 2016. When data passed to <code>addMinicharts</code> contains a single column, it automatically represents it with circle which area is proportional to the corresponding value. In the example we also use the parameter <code>showLabels</code> to display rounded values of the variable inside the circles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>basemap <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMinicharts</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    prod2016<span class="sc">$</span>lng, prod2016<span class="sc">$</span>lat,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">chartdata =</span> prod2016<span class="sc">$</span>load,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">showLabels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">45</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-a437209bd6c6ca6e940a" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-a437209bd6c6ca6e940a">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["http://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false}]},{"method":"addMinicharts","args":[[{"dyn":{},"static":{"type":"polar-area","width":45,"height":30,"opacity":1,"labels":"auto","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (-0.813282566731742,47.4792988912507)","lat":47.47929889125071,"lng":-0.8132825667317425},"timeSteps":1},{"dyn":{},"static":{"type":"polar-area","width":45,"height":30,"opacity":1,"labels":"auto","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (-2.84162054154278,48.1729948540771)","lat":48.17299485407708,"lng":-2.841620541542783},"timeSteps":1},{"dyn":{},"static":{"type":"polar-area","width":45,"height":30,"opacity":1,"labels":"auto","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (0.110020840062141,49.1203330851779)","lat":49.12033308517789,"lng":0.1100208400621413},"timeSteps":1},{"dyn":{},"static":{"type":"polar-area","width":45,"height":30,"opacity":1,"labels":"auto","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (0.218483284171458,45.2025394648037)","lat":45.20253946480369,"lng":0.2184832841714578},"timeSteps":1},{"dyn":{},"static":{"type":"polar-area","width":45,"height":30,"opacity":1,"labels":"auto","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (1.68510931295538,47.4847992664932)","lat":47.48479926649323,"lng":1.685109312955383},"timeSteps":1},{"dyn":{},"static":{"type":"polar-area","width":45,"height":30,"opacity":1,"labels":"auto","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (2.145955512601,43.7024322746127)","lat":43.7024322746127,"lng":2.145955512601003},"timeSteps":1},{"dyn":{},"static":{"type":"polar-area","width":45,"height":30,"opacity":1,"labels":"auto","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (2.5040817406415,48.7093394514858)","lat":48.70933945148577,"lng":2.504081740641503},"timeSteps":1},{"dyn":{},"static":{"type":"polar-area","width":45,"height":30,"opacity":1,"labels":"auto","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (2.77194462302643,49.9699454427889)","lat":49.96994544278894,"lng":2.771944623026433},"timeSteps":1},{"dyn":{},"static":{"type":"polar-area","width":45,"height":30,"opacity":1,"labels":"auto","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (4.53733758362306,45.5126596875538)","lat":45.51265968755384,"lng":4.537337583623057},"timeSteps":1},{"dyn":{},"static":{"type":"polar-area","width":45,"height":30,"opacity":1,"labels":"auto","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (4.80741109095619,47.2343259051064)","lat":47.23432590510637,"lng":4.807411090956194},"timeSteps":1},{"dyn":{},"static":{"type":"polar-area","width":45,"height":30,"opacity":1,"labels":"auto","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (5.61388404127418,48.6888920841392)","lat":48.68889208413923,"lng":5.61388404127418},"timeSteps":1},{"dyn":{},"static":{"type":"polar-area","width":45,"height":30,"opacity":1,"labels":"auto","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (6.06550427708522,43.9580632682766)","lat":43.95806326827664,"lng":6.065504277085216},"timeSteps":1}],[[[27576]],[[22463]],[[28623]],[[43794]],[[18748]],[[37560]],[[72986]],[[51273]],[[67514]],[[21883]],[[46388]],[[41868]]],72986,["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","e377c2","#7f7f7f","#bcbd22","#17becf"],["1"],null,{"showTitle":true,"showValues":true,"supValues":null,"supLabels":[],"html":null,"noPopup":false,"digits":null,"labels":[]},null,null]}],"limits":{"lat":[43.7024322746127,49.96994544278894],"lng":[-2.841620541542783,6.065504277085216]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This is nice, isn’t it?</p>
</section>
<section id="animated-maps" class="level2">
<h2 class="anchored" data-anchor-id="animated-maps">Animated maps</h2>
<p>Until now, we have only represented aggregated data but it would be nice to create a map that represents the evolution over time of some variables. It is actually easy with <code>leaflet.minicharts</code>. The first step is to construct a table containing longitude, latitude, a time column and the variables we want to represent. The table <code>eco2mix</code> already has all these columns. We only need to filter the rows containing data for the entire country.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>prodRegions <span class="ot">&lt;-</span> eco2mix <span class="sc">%&gt;%</span> <span class="fu">filter</span>(area <span class="sc">!=</span> <span class="st">"France"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can create our animated map by using the argument “time”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>basemap <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMinicharts</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    prodRegions<span class="sc">$</span>lng, prodRegions<span class="sc">$</span>lat, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">chartdata =</span> prodRegions[, <span class="fu">c</span>(<span class="st">"hydraulic"</span>, <span class="st">"solar"</span>, <span class="st">"wind"</span>)],</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> prodRegions<span class="sc">$</span>month,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">colorPalette =</span> colors,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">45</span>, <span class="at">height =</span> <span class="dv">45</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-cf0b12a37fe4488799e2" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-cf0b12a37fe4488799e2">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["http://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false}]},{"method":"addMinicharts","args":[[{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (-0.813282566731742,47.4792988912507)","lat":47.47929889125071,"lng":-0.8132825667317425},"timeSteps":50},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (-2.84162054154278,48.1729948540771)","lat":48.17299485407708,"lng":-2.841620541542783},"timeSteps":50},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (0.110020840062141,49.1203330851779)","lat":49.12033308517789,"lng":0.1100208400621413},"timeSteps":50},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (0.218483284171458,45.2025394648037)","lat":45.20253946480369,"lng":0.2184832841714578},"timeSteps":50},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (1.68510931295538,47.4847992664932)","lat":47.48479926649323,"lng":1.685109312955383},"timeSteps":50},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (2.145955512601,43.7024322746127)","lat":43.7024322746127,"lng":2.145955512601003},"timeSteps":50},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (2.5040817406415,48.7093394514858)","lat":48.70933945148577,"lng":2.504081740641503},"timeSteps":50},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (2.77194462302643,49.9699454427889)","lat":49.96994544278894,"lng":2.771944623026433},"timeSteps":50},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (4.53733758362306,45.5126596875538)","lat":45.51265968755384,"lng":4.537337583623057},"timeSteps":50},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (4.80741109095619,47.2343259051064)","lat":47.23432590510637,"lng":4.807411090956194},"timeSteps":50},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (5.61388404127418,48.6888920841392)","lat":48.68889208413923,"lng":5.61388404127418},"timeSteps":50},{"dyn":{},"static":{"type":"bar","width":45,"height":45,"opacity":1,"labels":"none","labelMinSize":8,"labelMaxSize":24,"transitionTime":750,"fillColor":"#1f77b4","layerId":"_minichart (6.06550427708522,43.9580632682766)","lat":43.95806326827664,"lng":6.065504277085216},"timeSteps":50}],[[[1,7,75],[1,14,96],[1,21,86],[2,31,96],[1,34,66],[0,35,59],[0,43,64],[0,42,46],[0,29,57],[0,19,88],[1,11,117],[1,12,128],[2,9,144],[2,17,179],[2,33,81],[2,36,78],[2,43,92],[1,49,61],[0,45,55],[1,40,54],[0,41,48],[0,26,70],[2,14,101],[2,9,105],[3,12,130],[3,21,131],[3,31,121],[2,44,88],[1,48,89],[0,58,71],[0,53,73],[0,47,56],[0,44,95],[0,29,88],[0,15,124],[1,13,150],[2,13,173],[2,23,165],[3,36,165],[3,43,98],[2,49,83],[1,43,62],[0,57,56],[0,58,70],[0,39,48],[0,44,93],[0,18,145],[0,15,95],[0,19,112],[1,21,154]],[[56,3,118],[47,7,122],[50,10,120],[41,16,166],[36,18,114],[42,18,101],[34,22,87],[39,20,60],[38,14,67],[39,10,136],[38,5,141],[48,5,168],[57,5,200],[49,8,218],[56,15,110],[38,17,103],[48,21,103],[43,24,77],[47,23,65],[47,19,76],[42,19,48],[46,11,117],[52,6,125],[54,4,150],[58,5,183],[53,9,162],[53,14,163],[46,21,104],[45,21,112],[45,27,97],[41,22,89],[48,20,83],[42,20,97],[45,12,110],[44,6,195],[46,5,250],[53,5,225],[53,9,200],[54,16,190],[48,20,117],[48,23,85],[46,18,63],[49,25,64],[48,25,88],[44,17,75],[46,21,95],[45,7,164],[47,6,106],[48,8,125],[47,9,177]],[[15,1,87],[11,3,89],[15,5,73],[14,10,93],[8,10,68],[8,11,66],[10,14,47],[10,12,41],[10,8,50],[10,5,108],[7,3,105],[11,3,135],[16,2,156],[15,5,166],[16,10,74],[15,11,53],[16,13,83],[11,15,41],[10,14,47],[13,12,65],[10,12,30],[11,7,95],[9,4,96],[9,2,135],[10,3,150],[12,5,108],[14,9,115],[11,14,72],[9,14,85],[10,17,73],[8,14,75],[8,13,54],[8,12,80],[7,7,72],[6,4,168],[8,3,202],[14,3,187],[13,6,160],[14,9,125],[13,13,88],[11,15,70],[3,12,56],[9,17,54],[9,16,74],[9,11,61],[9,12,70],[9,4,138],[10,4,96],[11,4,95],[12,5,148]],[[465,23,61],[570,42,70],[454,68,67],[509,82,56],[534,83,41],[456,90,37],[279,119,46],[96,107,30],[108,79,40],[203,59,65],[533,30,93],[355,42,101],[520,30,98],[595,48,128],[549,93,57],[374,107,58],[381,122,71],[273,144,52],[239,132,38],[158,135,37],[129,142,49],[175,112,61],[263,57,89],[451,44,76],[377,54,97],[422,87,98],[527,114,91],[401,186,68],[396,194,67],[191,235,46],[78,227,53],[63,206,46],[157,177,77],[163,141,74],[136,96,88],[164,94,111],[472,70,124],[650,110,125],[555,178,123],[490,209,60],[461,246,67],[533,237,46],[147,288,41],[57,288,40],[127,222,34],[99,183,63],[160,89,113],[184,93,77],[268,105,124],[260,120,134]],[[24,3,122],[27,7,150],[16,11,125],[23,17,135],[25,18,101],[11,20,102],[3,25,96],[2,23,66],[0,15,90],[5,10,136],[19,5,192],[12,7,193],[23,5,214],[28,9,272],[20,20,113],[6,20,90],[8,22,148],[3,25,102],[4,23,84],[5,22,88],[2,22,73],[8,14,111],[9,7,136],[17,4,190],[21,6,224],[23,10,197],[23,16,180],[10,25,150],[10,27,139],[2,32,116],[0,30,120],[0,27,101],[0,23,164],[1,15,109],[2,10,227],[1,8,195],[13,6,251],[26,11,245],[20,19,201],[22,23,110],[12,26,109],[17,24,75],[1,33,77],[0,33,83],[0,23,58],[0,22,114],[6,9,201],[3,9,92],[4,9,168],[8,11,218]],[[1214,34,208],[1406,53,209],[1437,76,186],[1374,86,183],[1544,106,214],[1188,115,199],[1075,134,76],[780,115,138],[611,98,160],[698,73,184],[1117,42,246],[1095,52,188],[1384,40,189],[1670,61,198],[1705,116,220],[1291,125,189],[1197,147,237],[1029,164,140],[912,149,203],[743,150,116],[564,133,104],[610,112,133],[687,55,186],[1196,46,270],[1085,62,230],[1353,79,219],[1372,114,252],[1129,167,176],[1176,182,234],[920,198,137],[650,196,189],[539,181,154],[487,151,164],[545,113,171],[655,88,241],[683,67,144],[1074,57,192],[1320,90,268],[1442,140,244],[1285,168,260],[1214,199,311],[1086,208,200],[680,231,194],[516,233,192],[427,187,177],[485,152,165],[651,80,231],[897,84,201],[1077,89,300],[1043,104,263]],[[0,0,3],[0,2,3],[3,3,2],[4,6,3],[0,6,2],[3,7,2],[6,9,2],[5,8,1],[5,5,2],[3,3,3],[0,1,4],[2,1,5],[1,1,5],[0,2,6],[4,6,2],[6,6,2],[5,8,3],[3,9,2],[3,7,1],[5,7,2],[4,7,1],[5,4,2],[5,2,2],[4,1,4],[2,1,4],[2,3,4],[4,5,3],[4,8,2],[3,8,2],[5,10,2],[3,9,2],[4,8,3],[5,7,6],[6,4,3],[5,2,8],[7,1,7],[7,1,9],[1,3,9],[3,5,8],[5,7,4],[6,7,4],[0,7,2],[5,9,2],[4,9,3],[4,6,2],[4,7,4],[5,2,6],[7,2,2],[7,2,5],[7,2,6]],[[1,1,267],[1,4,283],[1,7,275],[1,12,300],[1,12,233],[1,13,244],[1,17,170],[0,14,144],[0,10,167],[1,6,377],[1,2,335],[1,3,462],[1,2,525],[1,5,561],[1,11,259],[1,13,186],[1,14,289],[0,16,147],[0,14,170],[1,13,241],[0,11,119],[0,7,319],[1,4,306],[1,2,515],[1,3,534],[1,5,395],[1,10,465],[1,15,317],[1,15,350],[0,19,315],[0,15,347],[0,14,231],[0,11,346],[0,7,241],[0,3,661],[1,3,758],[1,3,734],[1,5,674],[1,9,539],[1,13,375],[1,15,306],[1,12,249],[1,17,240],[1,16,312],[0,12,232],[0,12,282],[0,4,531],[0,4,377],[0,4,417],[1,4,597]],[[3047,14,66],[2808,21,66],[2582,34,62],[2948,39,55],[3745,51,56],[3252,60,65],[2929,69,36],[2108,64,47],[1810,48,50],[2315,30,81],[2906,16,77],[2526,22,79],[3116,18,75],[2916,26,80],[2781,59,70],[2287,65,57],[2525,73,89],[2189,86,55],[2880,68,53],[2487,76,38],[1570,68,48],[1617,51,52],[2228,25,67],[2269,17,74],[2659,24,70],[2798,33,66],[2737,57,74],[2487,81,66],[2907,91,86],[2606,101,44],[1952,106,57],[1609,91,55],[1519,73,70],[1796,48,62],[1563,40,75],[1698,33,69],[2617,24,85],[3070,32,90],[2688,62,90],[2696,74,83],[2815,89,95],[3246,93,45],[2603,106,53],[1809,106,51],[1531,81,50],[1441,71,64],[1978,31,84],[1904,34,59],[2224,32,88],[1905,45,100]],[[121,2,21],[124,5,25],[84,10,21],[96,14,25],[121,15,18],[81,19,18],[45,23,17],[34,21,11],[113,15,17],[76,10,31],[82,5,39],[81,6,37],[153,5,38],[100,8,51],[83,19,25],[32,20,19],[46,23,33],[18,27,25],[85,20,20],[73,21,21],[66,21,19],[40,13,27],[55,7,36],[70,3,55],[122,4,75],[103,10,61],[94,17,53],[91,24,50],[83,25,51],[26,28,34],[18,29,42],[17,26,38],[49,21,64],[40,13,45],[37,9,89],[57,8,87],[99,6,104],[139,7,111],[112,17,91],[101,19,51],[113,23,62],[127,23,36],[38,30,28],[18,29,32],[51,22,36],[33,21,65],[54,7,93],[54,7,64],[63,7,92],[69,10,106]],[[814,7,278],[708,14,332],[697,29,316],[835,41,362],[971,42,224],[933,56,251],[919,65,226],[690,57,141],[669,41,233],[732,26,386],[775,12,438],[659,13,497],[712,13,535],[627,18,609],[609,47,267],[555,49,206],[816,58,363],[659,69,248],[963,54,203],[983,51,226],[764,48,174],[684,28,275],[725,13,344],[627,5,521],[808,9,579],[578,20,450],[762,44,468],[854,57,346],[970,58,346],[936,65,307],[696,68,338],[557,60,293],[478,45,491],[481,27,300],[454,16,651],[512,16,590],[701,13,727],[796,17,803],[708,35,627],[822,46,382],[987,56,320],[985,54,214],[1004,65,188],[852,63,216],[626,49,196],[475,37,357],[625,14,568],[409,13,319],[362,16,489],[528,21,596]],[[1079,38,12],[1085,46,12],[1032,56,10],[1292,64,7],[1538,89,10],[1350,99,11],[1084,101,4],[768,99,7],[750,83,7],[763,55,8],[824,39,13],[844,38,10],[989,34,8],[1014,44,8],[1124,91,8],[1176,98,9],[1103,118,11],[797,116,5],[1036,121,9],[781,128,5],[613,98,7],[582,79,8],[842,40,7],[1030,42,15],[1033,54,12],[963,64,11],[813,91,10],[658,120,8],[865,139,11],[881,139,6],[584,149,6],[581,134,5],[691,113,10],[797,82,8],[652,74,10],[479,41,3],[570,49,5],[803,70,11],[940,108,11],[938,125,12],[840,149,13],[1105,153,6],[746,169,8],[555,163,7],[554,131,5],[476,103,9],[672,63,9],[923,64,7],[1100,64,15],[581,70,10]]],3745,["#3093e5","#fcba50","#a0d9e8"],["2013-01","2013-02","2013-03","2013-04","2013-05","2013-06","2013-07","2013-08","2013-09","2013-10","2013-11","2013-12","2014-01","2014-02","2014-03","2014-04","2014-05","2014-06","2014-07","2014-08","2014-09","2014-10","2014-11","2014-12","2015-01","2015-02","2015-03","2015-04","2015-05","2015-06","2015-07","2015-08","2015-09","2015-10","2015-11","2015-12","2016-01","2016-02","2016-03","2016-04","2016-05","2016-06","2016-07","2016-08","2016-09","2016-10","2016-11","2016-12","2017-01","2017-02"],null,{"showTitle":true,"showValues":true,"labels":["hydraulic","solar","wind"],"supValues":null,"supLabels":[],"html":null,"noPopup":false,"digits":null},null,null]},{"method":"addLegend","args":[{"colors":["#3093e5","#fcba50","#a0d9e8"],"labels":["hydraulic","solar","wind"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":null,"extra":null,"layerId":"minichartsLegend","className":"info legend","group":null}]}],"limits":{"lat":[43.7024322746127,49.96994544278894],"lng":[-2.841620541542783,6.065504277085216]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="represent-flows" class="level2">
<h2 class="anchored" data-anchor-id="represent-flows">Represent flows</h2>
<p>Since version 0.2, <code>leaflet.minicharts</code> has also functions to represent flows between points and their evolution. To illustrate this, let’s represent the evolution of electricity exchanges between France and Neighboring countries.</p>
<p>To do that, we use function <code>addFlows</code>. It requires coordinates of two points for each flow and the value of the flow. Other arguments are similar to <code>addMinicharts</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"eco2mixBalance"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>bal <span class="ot">&lt;-</span> eco2mixBalance</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>basemap <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addFlows</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    bal<span class="sc">$</span>lng0, bal<span class="sc">$</span>lat0, bal<span class="sc">$</span>lng1, bal<span class="sc">$</span>lat1,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> bal<span class="sc">$</span>balance,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> bal<span class="sc">$</span>month</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-c571401af4e3adb89a07" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-c571401af4e3adb89a07">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["http://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false}]},{"method":"addFlows","args":[[{"dyn":{"value":[-358,-333,-360,-337,-147,11,32,377,70,-156,-29,-395,-227,-192,-399,-171,122,354,469,606,349,352,-100,295,724,-309,330,-9,251,482,494,334,72,-273,-172,-30,91,-306,-636,-464,512,543,521,674,397,285,-277,366,-254,-633,-192,-162,663,668,694,812,755,505,462,244,622,-373,44,408,817,751,668,688,465,481,1080,1664,390,387,289,-377,637,1201,1306,1391,1219,44,369,945,-346,400]},"static":{"color":"blue","maxValue":2491,"minThickness":1,"maxThickness":20,"opacity":1,"layerId":"_flow (2.213749,46.22764) -> (-1.7539181,42.1685273)","lat0":46.22764,"lat1":42.1685273,"lng0":2.213749,"lng1":-1.7539181},"timeSteps":86},{"dyn":{"value":[-652,-497,-365,67,486,979,1013,1293,473,-353,195,387,519,270,382,455,203,561,666,598,322,109,-50,766,929,-798,583,547,693,447,822,948,1011,183,597,529,493,465,566,819,1073,928,1401,1199,1171,878,949,535,1405,1278,979,1307,1417,1075,1417,1429,1268,937,1362,1263,1081,1006,1153,1310,1403,1320,1366,1342,1345,831,828,1059,1148,1344,1450,1124,1359,1226,1122,1074,487,-117,-43,-150,-441,407]},"static":{"color":"blue","maxValue":2491,"minThickness":1,"maxThickness":20,"opacity":1,"layerId":"_flow (2.213749,46.22764) -> (-1.890401,52.486243)","lat0":46.22764,"lat1":52.486243,"lng0":2.213749,"lng1":-1.890401},"timeSteps":86},{"dyn":{"value":[1297,1628,1784,1522,1229,1465,1632,828,1329,1274,1400,747,1364,1630,1541,1456,1338,1267,1019,778,776,1636,1674,1601,1581,1244,1742,1271,1341,1207,825,610,790,1621,1586,1292,1499,1545,1170,1015,1159,1289,963,905,1207,1796,1462,1344,1757,1818,1836,1187,1214,1362,1366,1194,1734,2272,1984,1574,2001,1821,1790,1337,1389,1458,1522,1012,1679,1522,2105,2090,2107,2073,1884,1619,1492,1376,1695,903,1410,819,806,343,729,1802]},"static":{"color":"blue","maxValue":2491,"minThickness":1,"maxThickness":20,"opacity":1,"layerId":"_flow (2.213749,46.22764) -> (12.56738,41.87194)","lat0":46.22764,"lat1":41.87194,"lng0":2.213749,"lng1":12.56738},"timeSteps":86},{"dyn":{"value":[-2390,-1541,-1037,-667,-780,1154,400,1276,44,-1637,-1085,-1322,-58,127,772,1085,1455,1711,1734,1142,743,-451,42,-116,-59,-2430,-1,-31,1079,913,287,877,769,321,639,859,-265,-1135,-880,559,1886,1681,1196,1688,795,-263,-881,-1256,611,-66,155,682,1583,1440,2448,2260,714,-151,577,358,-553,-982,-258,98,1529,1965,2084,2491,1028,482,-288,-894,-977,-1029,-1124,211,1322,2070,232,-463,-794,-1272,-1683,-1846,-1465,-1063]},"static":{"color":"blue","maxValue":2491,"minThickness":1,"maxThickness":20,"opacity":1,"layerId":"_flow (2.213749,46.22764) -> (6.3598362,50.4463879)","lat0":46.22764,"lat1":50.4463879,"lng0":2.213749,"lng1":6.3598362},"timeSteps":86},{"dyn":{"value":[1613,1752,2022,1900,1287,1578,1412,2021,1595,1323,1730,1268,1984,1960,2226,2160,2140,2074,2170,2088,1953,2074,2191,2186,2195,1579,2235,1670,1060,599,787,792,1413,1774,1705,1718,1666,1563,1513,1283,1090,1188,1372,1705,1136,1177,1129,1666,2160,1740,1575,807,1375,1419,2001,1909,648,543,1186,1094,1770,1334,1374,741,641,369,414,1151,486,1374,2010,2223,2208,1983,1526,925,214,514,-322,305,185,1047,963,581,572,1871]},"static":{"color":"blue","maxValue":2491,"minThickness":1,"maxThickness":20,"opacity":1,"layerId":"_flow (2.213749,46.22764) -> (8.227512,46.818188)","lat0":46.22764,"lat1":46.818188,"lng0":2.213749,"lng1":8.227512000000001},"timeSteps":86}],["2010-01","2010-02","2010-03","2010-04","2010-05","2010-06","2010-07","2010-08","2010-09","2010-10","2010-11","2010-12","2011-01","2011-02","2011-03","2011-04","2011-05","2011-06","2011-07","2011-08","2011-09","2011-10","2011-11","2011-12","2012-01","2012-02","2012-03","2012-04","2012-05","2012-06","2012-07","2012-08","2012-09","2012-10","2012-11","2012-12","2013-01","2013-02","2013-03","2013-04","2013-05","2013-06","2013-07","2013-08","2013-09","2013-10","2013-11","2013-12","2014-01","2014-02","2014-03","2014-04","2014-05","2014-06","2014-07","2014-08","2014-09","2014-10","2014-11","2014-12","2015-01","2015-02","2015-03","2015-04","2015-05","2015-06","2015-07","2015-08","2015-09","2015-10","2015-11","2015-12","2016-01","2016-02","2016-03","2016-04","2016-05","2016-06","2016-07","2016-08","2016-09","2016-10","2016-11","2016-12","2017-01","2017-02"],null,{"showTitle":true,"showValues":true,"labels":["Flow"],"supValues":null,"supLabels":[],"html":null,"noPopup":false,"digits":null},null]}],"limits":{"lat":[41.87194,52.486243],"lng":[-1.890401,12.56738]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Of course, you can represent flows and minicharts on the same map!</p>
</section>
<section id="use-in-shiny-web-applications" class="level2">
<h2 class="anchored" data-anchor-id="use-in-shiny-web-applications">Use in shiny web applications</h2>
<p>In shiny applications, you can create nice transition effects by using functions <code>leafletproxy</code> and <code>updateMinicharts</code>/<code>updateFlows</code>. In the server function you first need to initialize the map and the minicharts. The important thing here is to use parameter <code>layerId</code> so that <code>updateMinicharts</code> can know which chart to update with which values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize map</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>mymap <span class="ot">&lt;-</span> <span class="fu">renderLeaflet</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addMinicharts</span>(lon, lat, <span class="at">layerId =</span> uniqueChartIds)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then use <code>leafletProxy()</code> and <code>updateMinicharts</code> in your reactive code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize map</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  ...</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update map</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">observe</span>({</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    newdata <span class="ot">&lt;-</span> <span class="fu">getData</span>(input<span class="sc">$</span>myinput)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">leafletProxy</span>(<span class="st">"mymap"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">updateMinicharts</span>(uniqueChartIds, <span class="at">chartdata =</span> newdata, ...)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can find a <a href="https://francoisguillem.shinyapps.io/shiny-demo/">live example here</a>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопировано");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопировано");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>